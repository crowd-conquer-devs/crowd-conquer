<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Crowd Conquer</title>
    <link type="text/css" type="text/css" href="css/style.css" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true"></script>
    <link type="text/css" href="css/bootstrap.min.css" rel="stylesheet">
    <link type="text/css" href="css/bootstrap-responsive.min.css" rel="stylesheet">
    <link type="text/css" href="css/simple-sidebar.css" rel="stylesheet">
    <link type="text/css" href="css/style.css" rel="stylesheet">
</head>

<template name="das">
    {{#each d}}
        {{email}}
    {{/each}}
</template>

<template name="map">
    <div id="wrapper">
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand white bold" id="user-logo-sidebar">
                    Crowd Conquer
                </li>
                <div id="profilePicContainer">
                    <img src="{{profilePicture}}" class="circlePic" />
                </div>
                {{#if iHaveTeam}}
                <li>
                    <a href="#" onclick="showLeave()">Leave team</a>
                </li>
                {{else}}
                <li>
                    <a href="#" onclick="showCreate()">Create team</a>
                </li>
                <li>
                    <a href="#" onclick="showJoin()">Join team</a>
                </li>
                {{/if}}
                <li>
                    <a href="#" onclick="showRanking()">Ranking</a>
                </li>
                <li>
                    <a href="#" onclick="showAbout()">About</a>
                </li>
            </ul>
        </div>
    </div>

    <div id="login-absolute">
        <span class="icon-tasks pointer mr5"></span>
        {{> loginButtons}}
        <b>{{myTeam}}</b>
    </div>

    <div id="map-canvas"></div>
    {{dummy}}

    <div id="create-panel" class="main-panel">
        <h2>Create team</h2>
        <p>Anyone can join your team and conquer tiles.</p>
        <p>Name: <input type="text" class="form-control" id="name"></p>
        <div id="createButton" class="button-flat-bottom">
            Create
        </div>
    </div>

    <div id="join-panel" class="main-panel">
        <div class="bottom-flat-bottom">
            <h2>Join</h2>
            <p>Coming soon!</p>
        </div>
    </div>

    <div id="ranking-panel" class="main-panel">
        <h2>Ranking</h2>
        <p>Coming soon!</p>
    </div>

    <div id="about-panel" class="main-panel">
        <h2>About</h2>
        <p>Rekt rekt rekt...</p>
    </div>

    <script>
        $("#wrapper").removeClass("toggled");
        $("#login-absolute").click(function(e) {
            e.preventDefault();
            $("#wrapper").toggleClass("toggled");
            resetMainPanel();
        });
        $("#map-canvas").click(function(e) {
            $("#wrapper").removeClass("toggled");
            $(".main-panel").hide();
        });

        function showLeave() {
            Meteor.call('leaveTeam');
        }

        function showJoin() {
            resetMainPanel();
            $("#join-panel").show();
        }

        function showCreate() {
            resetMainPanel();
            $("#create-panel").show();
        }

        function showRanking() {
            resetMainPanel();
            $("#ranking-panel").show();
        }

        function showAbout() {
            resetMainPanel();
            $("#about-panel").show();
        }

        function resetMainPanel() {
            $(".main-panel").hide();
            $(".main-panel").css({height: $(window).height()/2, top: $(window).height()*0.25});
        }

        $("#map-canvas").mousemove(function(event) {
            if (!$("#wrapper").hasClass("toggled")) {
                if (event.pageX == 0) {
                    $("#wrapper").toggleClass("toggled");
                    resetMainPanel();
                }
            }
        });
    </script>

    <script src="js/bootstrap.min.js"></script>

</template>
